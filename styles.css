:root { /* ... keep variables ... */ }
body[data-theme="dark"] { /* ... keep dark theme ... */ }
body[data-theme="pastel"] { /* ... keep pastel theme ... */ }
body[data-theme="velvet"] { /* ... keep velvet theme ... */ }

/* --- General Styles & Resets --- */
/* ... keep general styles ... */

/* --- Layout & Structure --- */
/* ... keep layout styles ... */

/* --- Header --- */
/* ... keep header styles ... */

/* --- Form Section --- */
/* ... keep form styles ... */

/* Avatar Picker */
/* ... keep avatar styles ... */

/* Traits Area */
/* ... keep traits styles ... */

/* Trait Info & Context Help Popups */
/* ... keep popup styles ... */

/* Form Actions (Save/Clear Buttons) */
/* ... keep form action styles ... */

/* --- List Section --- */
/* ... keep list styles ... */

/* Small buttons */
/* ... keep small-btn styles ... */

/* --- Preview Section --- */
/* ... keep preview styles ... */

/* --- Modals (General) --- */
/* ... keep general modal styles ... */

/* --- Persona Detail Modal --- */
/* ... keep detail modal styles ... */

/* Detail Modal Tabs - NEW */
/* ... keep tab styles ... */

/* Detail Modal Tab Content - NEW */
/* ... keep tab content styles ... */

/* Goals Section (Detail Modal) */
/* ... keep goal styles ... */

/* Style Breakdown (Detail Modal) */
/* ... keep breakdown styles ... */

/* Trait Details Grid (Detail Modal) */
/* ... keep trait grid styles ... */

/* History Section (Detail Modal) */
/* ... keep history styles ... */

/* Achievements Section (Detail Modal) */
/* ... keep achievements styles ... */

/* Kink Reading Section (Detail Modal) */
/* ... keep reading styles ... */

/* Reflections Section (Detail Modal) */
/* ... keep reflections styles ... */

/* --- Achievements Modal --- NEW */
/* ... keep achievements modal styles ... */

/* --- Other Auxiliary Modals --- */
/* ... keep aux modal styles ... */

/* --- Highlighting --- NEW */
/* ... keep highlight styles ... */

/* --- Style Finder Specific Styles --- */

/* Style Finder Modal container */
.sf-modal .sf-modal-content {
  background: var(--sf-modal-bg, var(--card-bg-color)); /* Use specific SF var or fallback */
  padding: 2em;
  border-radius: var(--border-radius-medium);
  max-width: 95%;
  width: 650px; /* Slightly narrower maybe? Adjust as needed */
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: var(--card-shadow);
  transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing);
  display: flex;
  flex-direction: column;
  text-align: center; /* <<< ADDED FOR CENTERING INTERNAL CONTENT */
  margin-left: auto; /* Added for centering the modal content itself if needed */
  margin-right: auto; /* Added for centering the modal content itself if needed */
}

.sf-modal-content h3 { /* Title inside SF modal */
  margin-top: 0;
  margin-bottom: 1em;
  color: var(--accent-color);
}

#sf-close-style-finder { /* Already styled via .modal-close */
  /* Keep existing .modal-close styles */
}

#sf-progress-tracker {
  font-size: 0.9em;
  color: var(--sf-progress-color, var(--muted-text-color));
  margin-bottom: 1em; /* Increased margin */
}

#sf-step-content {
    padding: 0.5em 0;
    position: relative;
    min-height: 150px; /* Ensure some space for loading */
    /* text-align: center; <<< Already added to sf-modal-content */
}
#sf-step-content.loading::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(var(--card-bg-color-rgb, 255, 255, 255), 0.7);
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
    /* Add spinner styles if desired */
    /* background-image: url('spinner.gif'); */
    /* background-repeat: no-repeat; */
    /* background-position: center; */
}
body[data-theme="dark"] #sf-step-content.loading::after,
body[data-theme="velvet"] #sf-step-content.loading::after {
    background: rgba(var(--card-bg-color-rgb, 44, 31, 62), 0.7);
}
#sf-step-content h2 {
  color: var(--accent-color);
  margin-bottom: 1em; /* Increased margin */
  font-size: 1.4em;
}

#sf-step-content p {
  margin-bottom: 1.5em; /* Increased margin */
}

/* Style Finder Button Container */
.sf-button-container {
    display: flex;
    flex-wrap: wrap;
    gap: 1em;
    justify-content: center; /* Center buttons horizontally */
    margin-top: 1.5em; /* Add space above buttons */
}

/* Ensure SF buttons inherit base styles */
#sf-step-content button {
  /* Base styles inherited from general button rules */
  /* Add any specific SF overrides if needed */
}

#sf-step-content button.save-btn { /* Primary action */
    /* Styles inherited */
}
#sf-step-content button.clear-btn { /* Secondary back/cancel */
    /* Styles inherited */
     background: var(--muted-text-color); /* Adjust if needed for SF */
     color: var(--card-bg-color);
}
#sf-step-content button.small-btn { /* Tertiary/other */
     /* Styles inherited */
      background: var(--border-color); /* Example: muted background */
      color: var(--text-color);
}
#sf-step-content button.small-btn:hover:not(:disabled) {
    background: var(--accent-color-light);
}


#sf-feedback {
  font-size: 0.9em;
  color: var(--accent-color);
  margin: 1em 0; /* Increased margin */
  min-height: 1.2em; /* Prevent layout jump */
  font-weight: bold;
}

#sf-dashboard {
  margin-top: 1.5em; /* Increased margin */
  font-size: 0.9em; /* Slightly larger? */
  color: var(--text-color);
  padding: 1em;
  background: var(--bg-color); /* Match app background slightly */
  border-radius: var(--border-radius-small);
  border: var(--border-width) dashed var(--border-color);
}
body[data-theme="dark"] #sf-dashboard,
body[data-theme="velvet"] #sf-dashboard {
     color: var(--text-color);
     background: var(--bg-color);
     border-color: var(--border-color);
}


.sf-dashboard-header {
  font-size: 1.2em;
  color: var(--accent-color);
  margin-bottom: 0.8em;
  text-align: center;
  font-weight: bold;
}

.sf-dashboard-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--sf-dashboard-item-bg, rgba(255, 112, 150, 0.05));
  border-radius: var(--border-radius-small); /* Smaller radius for items */
  padding: 0.6em 1em;
  margin: 0.4em 0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  transition: transform 0.2s ease;
}
body[data-theme="dark"] .sf-dashboard-item,
body[data-theme="velvet"] .sf-dashboard-item {
  background: var(--sf-dashboard-item-bg, rgba(248, 225, 233, 0.08));
}

.sf-style-name {
  /* font-family: 'Comic Sans MS', cursive; /* Removing this specific font */
  font-size: 1em;
  text-align: left;
  flex-grow: 1;
  padding-right: 10px;
}

.sf-dashboard-score {
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 5px;
  white-space: nowrap;
  color: var(--text-color); /* Ensure visibility */
}
body[data-theme="dark"] .sf-dashboard-score,
body[data-theme="velvet"] .sf-dashboard-score {
    color: var(--text-color);
}

.sf-move-up, .sf-move-down {
  color: var(--accent-color);
  font-size: 1.2em;
  opacity: 1;
  animation: sfFadeOut 1s ease forwards;
}

.sf-score-delta {
  font-size: 0.8em;
  padding: 2px 6px;
  border-radius: 10px;
  background: var(--highlight-bg-color); /* Use highlight bg */
}
.sf-score-delta.positive {
  color: var(--accent-color-darker); /* Use darker accent */
}
body[data-theme="dark"] .sf-score-delta.positive,
body[data-theme="velvet"] .sf-score-delta.positive {
     color: var(--accent-color-light);
}
.sf-score-delta.negative {
  color: var(--sf-score-delta-negative-color, var(--muted-text-color));
}

/* Style Finder Slider */
.sf-trait-slider {
  width: 100%;
  max-width: 400px; /* Center block with max-width */
  margin: 15px auto; /* Center using auto margins */
  display: block; /* Ensure it takes up width */
  -webkit-appearance: none;
  height: 8px;
  background: var(--sf-slider-track-bg, var(--border-color));
  border-radius: 5px;
  outline: none;
  transition: background 0.3s;
  accent-color: var(--accent-color); /* Apply theme color */
}
.sf-trait-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 22px; /* Slightly larger thumb */
  height: 22px;
  background: var(--accent-color);
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 2px solid var(--card-bg-color); /* Add border for contrast */
}
.sf-trait-slider::-moz-range-thumb {
  width: 20px; /* Adjust size for consistency */
  height: 20px;
  background: var(--accent-color);
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid var(--card-bg-color);
  transition: all 0.2s ease;
}
.sf-trait-slider::-webkit-slider-thumb:hover,
.sf-trait-slider::-moz-range-thumb:hover {
  background: var(--accent-color-darker);
  transform: scale(1.1);
}
.sf-trait-slider:active { cursor: grabbing; }

.sf-slider-description {
  font-size: 1em;
  color: var(--accent-color);
  margin-top: 10px;
  font-weight: bold;
  transition: all 0.2s ease;
  text-align: center;
  padding: 8px 12px; /* Adjusted padding */
  background: var(--highlight-bg-color); /* Use highlight */
  border-radius: var(--border-radius-small);
  max-width: 400px;
  margin-left: auto;
  margin-right: auto;
  min-height: 2.5em; /* Ensure space */
}

.sf-slider-footnote {
  font-size: 0.85em; /* Slightly larger */
  color: var(--sf-slider-footnote-color, var(--muted-text-color));
  margin-top: 8px; /* Increased margin */
  text-align: center;
}

/* Style Finder Info Icon */
.sf-info-icon {
  cursor: pointer;
  margin-left: 8px; /* Increased spacing */
  color: var(--accent-color);
  font-size: 1.1em; /* Slightly larger */
  vertical-align: middle;
  transition: transform 0.2s;
  background: none; /* Ensure it looks like icon */
  border: none;
  padding: 0;
}
.sf-info-icon:hover {
  transform: scale(1.2);
  color: var(--accent-color-darker);
}

/* SF Info Popups */
.sf-style-info-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--sf-popup-bg, var(--card-bg-color));
  padding: 2em; /* Increased padding */
  border-radius: var(--border-radius-medium);
  max-width: 500px; /* Default width */
  width: 90%;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25); /* Enhanced shadow */
  z-index: 1010; /* Above modal backdrop */
  text-align: left; /* Usually better for text popups */
  max-height: 80vh; /* Limit height */
  overflow-y: auto; /* Allow scroll */
}
body[data-theme="dark"] .sf-style-info-popup,
body[data-theme="velvet"] .sf-style-info-popup {
   background: var(--sf-popup-bg, #3b233a);
}

.sf-style-info-popup.wide-popup { /* For 'More Details' */
  max-width: 700px;
}

.sf-style-info-popup h3 { /* Title inside popup */
  color: var(--accent-color);
  margin-top: 0;
  margin-bottom: 1em;
  text-align: center;
}
.sf-style-info-popup h4 { /* Subheadings */
    margin-top: 1.5em;
    margin-bottom: 0.5em;
    color: var(--accent-color-darker);
    border-bottom: 1px dashed var(--border-color);
    padding-bottom: 0.3em;
}

.sf-style-info-popup p {
  margin-bottom: 1em;
  line-height: 1.6;
}
.sf-style-info-popup ul {
  list-style: disc;
  padding-left: 2em;
  margin-bottom: 1em;
}
.sf-style-info-popup li {
  margin-bottom: 0.5em;
}

.sf-close-btn { /* Close button for SF popups */
  position: absolute;
  top: 10px;
  right: 12px;
  background: none;
  border: none;
  font-size: 1.8em;
  line-height: 1;
  color: var(--muted-text-color);
  cursor: pointer;
  padding: 0.1em 0.3em;
  transition: color 0.2s ease, transform 0.2s ease;
}
.sf-close-btn:hover {
  color: var(--accent-color);
  transform: scale(1.15) rotate(90deg);
}

/* SF Result Section */
.sf-result-section {
  margin: 20px 0;
  text-align: center; /* Center align result content */
}
.sf-result-heading {
  color: var(--accent-color);
  border-bottom: 2px solid var(--accent-color);
  padding-bottom: 5px;
  display: inline-block; /* Allow border to fit content */
  margin-bottom: 1em;
}
.sf-result-section p {
  margin-bottom: 1em;
  text-align: left; /* Keep paragraphs left-aligned */
   max-width: 90%; /* Constrain width */
   margin-left: auto;
   margin-right: auto;
}
.sf-result-section p strong {
    color: var(--accent-color-darker);
}
.sf-result-section h3 { /* Match popup H4 style */
    margin-top: 1.8em;
    margin-bottom: 0.8em;
    color: var(--accent-color-darker);
    border-bottom: 1px dashed var(--border-color);
    padding-bottom: 0.4em;
    display: inline-block;
}
.sf-result-section ul {
  text-align: left;
  margin: 10px auto;
  max-width: 90%;
  list-style: '✧ ';
  padding-left: 1.5em;
}
.sf-result-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin-top: 1.5em;
}


/* --- Animations & Effects --- */
@keyframes sfFadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
@keyframes sfBounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
@keyframes sfSlideIn { from { transform: translateY(15px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
@keyframes sfFadeOut { from { opacity: 1; } to { opacity: 0; } }
/* (Keep other animations: spinner, briefHighlight, modalFadeIn) */
.spinner { /* ... */ }
@keyframes spin { /* ... */ }
button.loading .spinner { /* ... */ }
@keyframes briefHighlight { /* ... */ }
.item-just-saved { /* ... */ }
@keyframes briefInputBorder { /* ... */ }
.input-just-saved { /* ... */ }
@keyframes modalFadeIn { /* ... */ }


/* --- Footer --- */
/* ... keep footer styles ... */

/* --- Utility Classes --- */
/* ... keep utility styles ... */

/* --- Notification Styles --- */
/* ... keep notification styles ... */

/* --- Responsiveness --- */
/* ... keep responsive styles ... */
/* Add specific SF responsive adjustments if needed */
@media (max-width: 768px) {
    .sf-modal .sf-modal-content {
        width: 90%;
        padding: 1.5em;
    }
    #sf-step-content h2 {
        font-size: 1.25em;
    }
    .sf-trait-slider {
        max-width: 90%;
    }
    .sf-slider-description {
        max-width: 90%;
    }
     .sf-style-info-popup.wide-popup {
         max-width: 90%;
     }
}

@media (max-width: 480px) {
    .sf-modal .sf-modal-content {
        padding: 1em;
    }
     #sf-step-content h2 {
        font-size: 1.15em;
    }
    .sf-trait-slider {
        max-width: 95%;
    }
     .sf-slider-description {
        font-size: 0.9em;
        padding: 8px 10px;
    }
     .sf-slider-footnote {
        font-size: 0.8em;
    }
    .sf-style-info-popup {
        padding: 1em;
    }
    .sf-result-buttons {
        flex-direction: column; /* Stack buttons on very small screens */
        gap: 8px;
    }
}
