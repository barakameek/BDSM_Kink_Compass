
:root {
  /* Color Palette (Light Theme - Default) */
  --bg-color: #fff0f5; /* Lavender blush - soft pink */
  --card-bg-color: #ffffff; /* White cards */
  --text-color: #4a2c3d; /* Dark eggplant */
  --text-color-light: #ffffff; /* For on accent backgrounds */
  --accent-color: #ff69b4; /* Hot pink */
  --accent-color-darker: #d14790; /* Darker hot pink */
  --accent-color-light: #ffa5d8; /* Lighter hot pink */
  --muted-text-color: #8a5a6d; /* Muted eggplant/rose */
  --border-color: #f4d4e4; /* Light pink border */
  --focus-ring-color: var(--accent-color-light);
  --focus-ring-alpha: 0.4;
  --success-color: #4CAF50;
  --danger-color: #f44336;
  --link-color: var(--accent-color);
  --link-hover-color: var(--accent-color-darker);

  /* Shadows & Borders */
  --card-shadow: 0 5px 15px rgba(74, 44, 61, 0.1);
  --button-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  --input-shadow-inset: inset 0 1px 3px rgba(74, 44, 61, 0.08);
  --border-radius-medium: 15px;
  --border-radius-small: 10px;
  --border-width: 1px;
  --border-width-thick: 2px;

  /* Typography */
  --font-family-base: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  --font-size-base: 16px;
  --line-height-base: 1.6;

  /* Transitions */
  --transition-duration: 0.3s;
  --transition-timing: ease;

  /* Specific Component Variables */
  --chart-grid-color: rgba(74, 44, 61, 0.1);
  --chart-label-color: var(--muted-text-color);
  --chart-line-color: var(--accent-color);
  --chart-point-color: var(--accent-color-darker);
  --chart-tooltip-bg: rgba(0, 0, 0, 0.75);
  --chart-tooltip-text: #fff;

  /* Style Finder Specific (Can be overridden by themes) */
  --sf-modal-bg: var(--card-bg-color);
  --sf-progress-color: var(--muted-text-color);
  --sf-dashboard-item-bg: color-mix(in srgb, var(--accent-color) 5%, transparent);
  --sf-slider-track-bg: var(--border-color);
  --sf-slider-footnote-color: var(--muted-text-color);
  --sf-popup-bg: var(--card-bg-color);
  --sf-score-delta-negative-color: var(--muted-text-color);
  /* Notification variables */
  --notification-info-bg: #2196F3;
  --notification-success-bg: var(--success-color);
  --notification-error-bg: var(--danger-color);
  --notification-warning-bg: #ff9800;
  --notification-text-light: #ffffff;
  --notification-text-dark: #000000;
}

/* --- Dark Theme --- */
body[data-theme="dark"] {
  --bg-color: #2a1b2a;
  --card-bg-color: #3c2f3c;
  --text-color: #f4d4e4;
  --text-color-light: #f4d4e4;
  --accent-color: #ff85cb;
  --accent-color-darker: #ff69b4;
  --accent-color-light: #e06ab0;
  --muted-text-color: #c49db1;
  --border-color: #5a3f5a;
  --focus-ring-color: var(--accent-color-light);
  --focus-ring-alpha: 0.5;
  --success-color: #66bb6a;
  --danger-color: #ef5350;
  --link-color: var(--accent-color);
  --link-hover-color: var(--accent-color-light);

  --card-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
  --input-shadow-inset: inset 0 1px 3px rgba(0, 0, 0, 0.3);

  --chart-grid-color: rgba(244, 212, 228, 0.15);
  --chart-label-color: var(--muted-text-color);
  --chart-line-color: var(--accent-color);
  --chart-point-color: var(--accent-color-darker);
  --chart-tooltip-bg: rgba(255, 255, 255, 0.85);
  --chart-tooltip-text: #000;

  --sf-modal-bg: #3b233a;
  --sf-progress-color: #d8b8cb;
  --sf-dashboard-item-bg: rgba(248, 225, 233, 0.1);
  --sf-slider-track-bg: #5a3a56;
  --sf-slider-footnote-color: #d8b8cb;
  --sf-popup-bg: #3b233a;
  --sf-score-delta-negative-color: #d8b8cb;

  --notification-info-bg: #64b5f6;
  --notification-success-bg: var(--success-color);
  --notification-error-bg: var(--danger-color);
  --notification-warning-bg: #ffb74d;
  --notification-text-light: #000000;
  --notification-text-dark: #ffffff;
}

/* --- Pastel Theme --- */
body[data-theme="pastel"] {
  --bg-color: #fdf6f9;
  --card-bg-color: #ffffff;
  --text-color: #6d5a6d;
  --accent-color: #a0d8ef;
  --accent-color-darker: #79b8d1;
  --accent-color-light: #c0e8f9;
  --muted-text-color: #b0a7b0;
  --border-color: #e8ddee;
  --focus-ring-color: var(--accent-color-light);
  --link-color: var(--accent-color-darker);
  --link-hover-color: #5a9cb0;

  --sf-dashboard-item-bg: color-mix(in srgb, var(--accent-color) 10%, transparent);
  --sf-slider-track-bg: #e8ddee;
  /* Use default light notification colors */
}

/* --- Velvet Theme --- */
body[data-theme="velvet"] {
  --bg-color: #1a122a;
  --card-bg-color: #2c1f3e;
  --text-color: #e8ddee;
  --accent-color: #dcc1ff;
  --accent-color-darker: #b899e0;
  --accent-color-light: #c8a8f0;
  --muted-text-color: #a08cb0;
  --border-color: #4a3a5f;
  --focus-ring-color: var(--accent-color-light);
  --link-color: var(--accent-color);
  --link-hover-color: var(--accent-color-light);

  --chart-grid-color: rgba(232, 221, 238, 0.15);
  --chart-label-color: var(--muted-text-color);
  --chart-line-color: var(--accent-color);
  --chart-point-color: var(--accent-color-darker);
  --chart-tooltip-bg: rgba(255, 255, 255, 0.8);
  --chart-tooltip-text: #000;

  --sf-modal-bg: #2c1f3e;
  --sf-progress-color: var(--muted-text-color);
  --sf-dashboard-item-bg: rgba(220, 193, 255, 0.1);
  --sf-slider-track-bg: #4a3a5f;
  --sf-slider-footnote-color: var(--muted-text-color);
  --sf-popup-bg: #2c1f3e;
  --sf-score-delta-negative-color: var(--muted-text-color);

  --notification-info-bg: #90caf9;
  --notification-success-bg: #81c784;
  --notification-error-bg: #e57373;
  --notification-warning-bg: #ffb74d;
  --notification-text-light: #000000;
  --notification-text-dark: #ffffff;
}

/* --- General Styles & Resets --- */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body { font-family: var(--font-family-base); background-color: var(--bg-color); color: var(--text-color); line-height: var(--line-height-base); font-size: var(--font-size-base); transition: background-color var(--transition-duration) var(--transition-timing), color var(--transition-duration) var(--transition-timing); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
h1, h2, h3, h4 { margin-bottom: 0.75em; color: var(--accent-color); line-height: 1.3; transition: color var(--transition-duration) var(--transition-timing); }
h1 { font-size: clamp(1.8em, 4vw, 2.4em); text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
h2 { font-size: clamp(1.5em, 3.5vw, 2em); }
h3 { font-size: clamp(1.2em, 3vw, 1.6em); margin-top: 1.5em; }
h4 { font-size: clamp(1.05em, 2.5vw, 1.25em); color: var(--text-color); margin-bottom: 0.5em; }
p { margin-bottom: 1em; }
ul { list-style: none; }
dl { margin-bottom: 1em; }
dt { font-weight: bold; color: var(--accent-color); margin-top: 1em; font-size: 1.05em; }
dd { margin-left: 1.5em; margin-bottom: 0.5em; }
dd ul { list-style: disc; padding-left: 1.5em; margin-top: 0.3em; }
a, .link-button { color: var(--link-color); text-decoration: none; transition: color var(--transition-duration) var(--transition-timing); cursor: pointer; }
a:hover, .link-button:hover { color: var(--link-hover-color); text-decoration: underline; }
.link-button { background: none; border: none; padding: 0; font: inherit; text-decoration: underline; }
*:focus-visible { outline: var(--border-width-thick) solid var(--focus-ring-color); outline-offset: 2px; box-shadow: 0 0 0 4px color-mix(in srgb, var(--focus-ring-color) calc(var(--focus-ring-alpha) * 100%), transparent); border-radius: 2px; /* Subtle radius on outline */ }
*:focus:not(:focus-visible) { outline: none; }


/* --- Layout & Structure --- */
.container { display: grid; grid-template-columns: repeat(auto-fit, minmax(min(100%, 340px), 1fr)); gap: 1.5em; padding: 1.5em; max-width: 1500px; margin: 1.5em auto; }
.card { background: var(--card-bg-color); padding: 1.5em; border-radius: var(--border-radius-medium); box-shadow: var(--card-shadow); border: var(--border-width) solid var(--border-color); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing), box-shadow var(--transition-duration) var(--transition-timing); }


/* --- Header --- */
.app-header { padding: 0.8em 1.5em; background: var(--accent-color); color: var(--text-color-light); display: flex; flex-wrap: wrap; justify-content: space-between; align-items: stretch; /* Stretch items vertically */ border-bottom: 3px solid color-mix(in srgb, var(--accent-color) 80%, black); box-shadow: 0 2px 8px rgba(0,0,0,0.15); position: sticky; top: 0; z-index: 500; transition: background-color var(--transition-duration) var(--transition-timing); min-height: 55px; /* Ensure header has height */ }
.app-header h1 { margin: 0 1em 0 0; font-size: clamp(1.4em, 3vw, 1.8em); color: var(--text-color-light); text-shadow: 1px 1px 2px rgba(0,0,0,0.2); flex-shrink: 0; margin-bottom: 0; display: flex; align-items: center; /* Center h1 content */ }
.header-nav { display: flex; flex-wrap: wrap; gap: 0.6em; align-items: stretch; /* Stretch buttons */ margin-left: auto; }
.header-btn { background: none; border: var(--border-width-thick) solid var(--text-color-light); color: var(--text-color-light); padding: 0.4em 0.8em; border-radius: var(--border-radius-small); cursor: pointer; font-size: clamp(0.75em, 1.5vw, 0.9em); font-weight: bold; transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease; white-space: nowrap; display: inline-flex; align-items: center; justify-content: center; text-align: center; }
.header-btn:hover, .header-btn:focus-visible { background: rgba(255, 255, 255, 0.2); transform: translateY(-1px); box-shadow: var(--button-shadow); }
.theme-btn { font-size: 1.2em; padding: 0.2em 0.5em; }

/* --- Form Section --- */
.form-section h2 { text-align: center; margin-bottom: 1.5em; }
#form-title { /* Specific ID */ }
.field-group { margin-bottom: 1.3em; }
.field-group label { display: block; font-weight: 600; margin-bottom: 0.5em; color: var(--accent-color); font-size: 0.95em; }
.field-group input[type="text"], .field-group select, .field-group textarea { width: 100%; padding: 0.8em 1em; font-size: 1em; border: var(--border-width) solid var(--border-color); border-radius: var(--border-radius-small); background: var(--bg-color); color: var(--text-color); transition: border-color var(--transition-duration) var(--transition-timing), background-color var(--transition-duration) var(--transition-timing), color var(--transition-duration) var(--transition-timing), box-shadow var(--transition-duration) var(--transition-timing); box-shadow: var(--input-shadow-inset); }
.field-group input[type="text"]:focus, .field-group select:focus, .field-group textarea:focus { border-color: var(--accent-color); background-color: var(--card-bg-color); }
.field-group select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%238a5a6d' viewBox='0 0 16 16'%3E%3Cpath d='M8 11.414l-4.707-4.707a1 1 0 011.414-1.414L8 8.586l3.293-3.293a1 1 0 111.414 1.414L8 11.414z'/%3E%3C/svg%3E"); /* Default color, consider dynamic SVG or mask */ background-repeat: no-repeat; background-position: right 0.8em center; background-size: 1em; padding-right: 2.5em; }
body[data-theme="dark"] .field-group select, body[data-theme="velvet"] .field-group select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23c49db1' viewBox='0 0 16 16'%3E%3Cpath d='M8 11.414l-4.707-4.707a1 1 0 011.414-1.414L8 8.586l3.293-3.293a1 1 0 111.414 1.414L8 11.414z'/%3E%3C/svg%3E"); }
body[data-theme="pastel"] .field-group select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23b0a7b0' viewBox='0 0 16 16'%3E%3Cpath d='M8 11.414l-4.707-4.707a1 1 0 011.414-1.414L8 8.586l3.293-3.293a1 1 0 111.414 1.414L8 11.414z'/%3E%3C/svg%3E"); }
.field-group textarea { resize: vertical; min-height: 80px; }

/* Avatar Picker */
.avatar-picker-fieldset { border: none; padding: 0; margin: 0; margin-top: 0.5em; }
.avatar-picker-fieldset legend { font-weight: 600; margin-bottom: 0.5em; color: var(--accent-color); padding: 0; font-size: 0.95em; }
.avatar-picker { display: flex; align-items: center; flex-wrap: wrap; gap: 0.6em; }
#avatar-display { font-size: 2em; margin-right: 0.5em; line-height: 1; transition: transform 0.2s ease; }
.avatar-btn { background: var(--bg-color); border: var(--border-width-thick) solid var(--border-color); border-radius: 50%; width: 40px; height: 40px; font-size: 1.6em; cursor: pointer; padding: 0; display: inline-flex; align-items: center; justify-content: center; transition: transform 0.15s ease, box-shadow 0.15s ease, border-color var(--transition-duration) var(--transition-timing), background-color var(--transition-duration) var(--transition-timing); }
.avatar-btn:hover { transform: scale(1.1); box-shadow: 0 0 8px color-mix(in srgb, var(--accent-color) 50%, transparent); border-color: var(--accent-color-light); }
.avatar-btn.selected { border-color: var(--accent-color); box-shadow: 0 0 10px var(--accent-color); transform: scale(1.1); background-color: color-mix(in srgb, var(--accent-color) 15%, transparent); }
.avatar-btn:focus-visible { border-color: var(--focus-ring-color); }

/* Traits Container */
#traits-container { margin-top: 1.5em; border-top: var(--border-width) dashed var(--border-color); padding-top: 1.5em; position: relative; transition: border-color var(--transition-duration) var(--transition-timing); }

/* Individual Trait Styling */
.trait { margin-bottom: 1.5em; background: color-mix(in srgb, var(--accent-color) 20%, transparent); padding: 1.2em; border-radius: var(--border-radius-small); border: var(--border-width) solid var(--border-color); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); position: relative; }
.trait label { font-weight: bold; color: var(--accent-color); display: inline-block; margin-right: 0.3em; margin-bottom: 0; vertical-align: middle; }
.trait-info-btn { background: none; border: none; color: var(--accent-color); cursor: pointer; font-size: 0.9em; padding: 0 0.3em; display: inline-flex; align-items: center; justify-content: center; vertical-align: middle; transition: color 0.2s ease, transform 0.2s ease; width: 20px; height: 20px; }
.trait-info-btn:hover { color: var(--accent-color-darker); transform: scale(1.2); }
.trait input[type="range"].trait-slider { width: 100%; accent-color: var(--accent-color); margin-top: 0.8em; margin-bottom: 0.3em; cursor: grab; display: block; height: 8px; }
.trait input[type="range"].trait-slider:active { cursor: grabbing; }
.trait-value { font-weight: bold; color: var(--accent-color-darker); display: inline-block; min-width: 1.5em; text-align: right; position: absolute; top: 1.2em; right: 1.2em; font-size: 0.9em; }
.trait-desc { font-size: 0.85em; color: var(--muted-text-color); padding: 0.5em 0 0 0; margin-top: 0.4em; clear: both; transition: color var(--transition-duration) var(--transition-timing); }

/* Trait Info Popup (Main Form) */
.trait-info-popup { display: none; position: absolute; left: 5%; right: 5%; top: 1em; width: 90%; max-width: 500px; z-index: 10; margin: 0 auto; padding: 1.5em; border: var(--border-width-thick) dashed var(--accent-color); background-color: var(--card-bg-color); box-shadow: 0 5px 15px rgba(0,0,0,0.2); border-radius: var(--border-radius-medium); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.trait-info-popup h4 { margin-top: 0; text-align: center; color: var(--accent-color); }
#trait-info-body p { margin-bottom: 0.8em; font-size: 0.9em; line-height: 1.5; }
#trait-info-body strong { color: var(--accent-color-darker); }
#trait-info-close { /* Uses .modal-close styles */ }

/* Form Actions (Save/Clear Buttons) */
.form-actions { display: flex; flex-wrap: wrap; gap: 1em; margin-top: 1.8em; justify-content: center; }
.save-btn, .clear-btn { border: none; padding: 0.8em 1.8em; font-size: 1.1em; border-radius: 50px; cursor: pointer; font-weight: bold; transition: transform 0.2s ease, background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease; }
.save-btn { background: var(--accent-color); color: var(--text-color-light); }
.save-btn:hover { background: var(--accent-color-darker); transform: translateY(-2px); box-shadow: var(--button-shadow); }
.clear-btn { background: var(--muted-text-color); color: var(--card-bg-color); }
.clear-btn:hover { background: var(--text-color); transform: translateY(-2px); box-shadow: var(--button-shadow); }
.save-btn:disabled { background: color-mix(in srgb, var(--muted-text-color) 70%, transparent); color: color-mix(in srgb, var(--text-color-light) 70%, transparent); cursor: not-allowed; transform: none; box-shadow: none; opacity: 0.7; }


/* --- List Section --- */
.list-section h2 { text-align: center; }
#people-list li { padding: 0.8em 1.2em; margin-bottom: 1em; background: var(--bg-color); border: var(--border-width) solid var(--border-color); border-left: 5px solid var(--accent-color); border-radius: var(--border-radius-small); display: flex; justify-content: space-between; align-items: center; transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease, transform 0.1s ease; cursor: pointer; }
#people-list li:hover, #people-list li:focus-within { background-color: color-mix(in srgb, var(--bg-color) 85%, var(--accent-color)); border-color: var(--accent-color); box-shadow: 0 2px 5px rgba(74, 44, 61, 0.1); transform: translateX(3px); }
#people-list li:focus-within { outline: var(--border-width-thick) solid var(--focus-ring-color); outline-offset: 1px; }
.person-info { display: flex; align-items: center; flex-grow: 1; margin-right: 1em; gap: 0.9em; }
.person-avatar { font-size: 1.6em; line-height: 1; }
.person-name-details { display: flex; flex-direction: column; }
.person-name { font-weight: bold; color: var(--text-color); transition: color var(--transition-duration) var(--transition-timing); }
.person-details { font-size: 0.85em; color: var(--muted-text-color); display: block; transition: color var(--transition-duration) var(--transition-timing); }
.person-actions { display: flex; gap: 0.5em; }

/* Small buttons (Edit/Delete in list, Goals etc) */
.small-btn { background: var(--accent-color); color: var(--text-color-light); border: none; padding: 0.4em 0.8em; border-radius: 15px; cursor: pointer; font-size: 0.85em; transition: background-color 0.2s ease, transform 0.1s ease; line-height: 1.2; display: inline-flex; align-items: center; justify-content: center; }
.small-btn:hover { background: var(--accent-color-darker); transform: scale(1.05); }
.delete-btn { background: var(--danger-color); }
.delete-btn:hover { background: color-mix(in srgb, var(--danger-color) 80%, black); }


/* --- Preview Section --- */
.preview-section { background: linear-gradient(135deg, var(--bg-color), color-mix(in srgb, var(--bg-color) 80%, var(--accent-color-light))); transition: background var(--transition-duration) var(--transition-timing); }
.preview-section h2 { text-align: center; }
#live-preview { padding: 1.5em; border: var(--border-width) solid var(--border-color); border-radius: var(--border-radius-small); background: var(--card-bg-color); min-height: 150px; transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.preview-title { text-align: center; margin-bottom: 1em; font-weight: bold; }
.preview-breakdown { margin-top: 1em; }
.core-trait-preview ul, .top-trait-preview { margin-top: 1em; padding-top: 1em; border-top: var(--border-width) dashed var(--border-color); transition: border-color var(--transition-duration) var(--transition-timing); }
.core-trait-preview ul { list-style: none; padding-left: 0; }
.core-trait-preview li { margin-bottom: 0.5em; font-size: 0.9em; }
.core-trait-preview li strong, .top-trait-preview strong { color: var(--accent-color-darker); transition: color var(--transition-duration) var(--transition-timing); }
.top-trait-preview hr { border: none; border-top: var(--border-width) dashed var(--border-color); margin: 1em 0; transition: border-color var(--transition-duration) var(--transition-timing); }
.top-trait-preview p { font-size: 0.9em; }


/* --- Modals (General) --- */
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.65); backdrop-filter: blur(3px); display: flex; align-items: center; justify-content: center; padding: 1em; overflow-y: auto; }
.modal-content { position: relative; background: var(--card-bg-color); padding: 2em; border-radius: var(--border-radius-medium); border: var(--border-width-thick) solid var(--accent-color); max-width: 95%; width: 700px; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.25); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); animation: modalFadeIn 0.3s ease; }
.modal-content.wide-modal { width: 900px; }
.modal-close { position: absolute; top: 12px; right: 15px; background: none; border: none; font-size: 2em; line-height: 1; color: var(--muted-text-color); cursor: pointer; padding: 0.1em 0.3em; transition: color 0.2s ease, transform 0.2s ease; }
.modal-close:hover { color: var(--accent-color); transform: scale(1.15) rotate(90deg); }
.modal h2 { margin-top: 0; text-align: center; color: var(--accent-color); }

@keyframes modalFadeIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

/* --- Persona Detail Modal --- */
#modal-body { padding: 0.5em; }
#modal-body section { margin-top: 1.8em; margin-bottom: 1.8em; padding: 1.5em; border: var(--border-width) solid var(--border-color); border-radius: var(--border-radius-small); background-color: color-mix(in srgb, var(--card-bg-color) 95%, var(--bg-color)); box-shadow: 0 2px 5px rgba(74, 44, 61, 0.05); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
#modal-body section h3 { margin-top: 0; margin-bottom: 1em; padding-bottom: 0.6em; border-bottom: var(--border-width) dashed var(--accent-color); display: flex; align-items: center; gap: 0.6em; font-size: 1.4em; transition: border-color var(--transition-duration) var(--transition-timing); }
.modal-title { font-size: 1.8em; margin-bottom: 0.2em; text-align: center; /* Center main title */ }
.modal-subtitle { text-align: center; margin-top: 0.2em; /* Reduced top margin */ margin-bottom: 1.5em; color: var(--muted-text-color); font-weight: bold; font-size: 1.05em; }
.modal-intro { font-style: italic; color: var(--accent-color-darker); text-align: center; margin: -0.5em auto 1.8em auto; font-size: 1.1em; max-width: 80%;}

/* Goals Section (Detail Modal) */
.goals-section ul { padding-left: 0; list-style: none; margin-top: 0.5em; }
.goals-section li { margin-bottom: 0.8em; padding: 0.8em 1em; background-color: var(--bg-color); border-radius: var(--border-radius-small); border: var(--border-width) solid var(--border-color); display: flex; justify-content: space-between; align-items: center; gap: 0.8em; list-style-position: inside; transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease; }
.goals-section li::before { content: 'ðŸŽ¯ '; margin-right: 0.4em; font-size: 1.1em; }
.goals-section li.done { text-decoration: line-through; color: var(--muted-text-color); background-color: color-mix(in srgb, var(--bg-color) 90%, #aaa); border-color: color-mix(in srgb, var(--border-color) 80%, #bbb); opacity: 0.7; }
.goals-section li.done::before { content: 'âœ”ï¸ '; }
.goals-section li > span:first-child { flex-grow: 1; word-break: break-word; }
.goal-actions button { margin-left: 0.3em; font-size: 0.9em; padding: 0.3em 0.6em; flex-shrink: 0; }
.add-goal-form { display: flex; gap: 0.5em; margin-top: 1.2em; }
.add-goal-form input { flex-grow: 1; padding: 0.6em 0.8em; width: auto; }
.add-goal-form button { flex-shrink: 0; }

/* Style Breakdown (Detail Modal) */
.style-breakdown { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5em; margin-top: 1em; margin-bottom: 0; padding: 0; border: none; background: none; box-shadow: none; }
.style-breakdown .strengths, .style-breakdown .improvements { padding: 1.2em; background: var(--bg-color); border-radius: var(--border-radius-small); border: var(--border-width) solid var(--border-color); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.style-breakdown h4 { color: var(--accent-color-darker); margin-bottom: 0.6em; margin-top: 0; font-size: 1.1em; }

/* Trait Tales Grid (Detail Modal) */
.trait-details-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.2em; margin-top: 1em; }
.trait-detail-item { border: var(--border-width) solid var(--border-color); padding: 1.2em; border-radius: var(--border-radius-small); background: var(--bg-color); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.trait-detail-item h4 { color: var(--accent-color); font-size: 1.15em; margin-top: 0; margin-bottom: 0.5em; }
.trait-detail-item p { margin-bottom: 0.5em; font-size: 0.9em; }
.trait-detail-item p:last-child { margin-bottom: 0; }
.trait-detail-item strong { color: var(--accent-color-darker); }
.trait-detail-item em { color: var(--muted-text-color); }

/* History Section (Detail Modal) */
.history-section h3 { display: flex; align-items: center; justify-content: space-between; }
.snapshot-info-btn { background: none; border: none; color: var(--muted-text-color); cursor: pointer; font-size: 1.1em; padding: 0 0.3em; transition: color 0.2s ease; }
.snapshot-info-btn:hover { color: var(--accent-color); }
.snapshot-info { font-size: 0.9em; background-color: var(--bg-color); padding: 0.8em; border: var(--border-width) dashed var(--border-color); border-radius: var(--border-radius-small); margin-top: 0.5em; margin-bottom: 1.2em; transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.history-chart-container{ max-width: 650px; margin: 1.8em auto 1.2em auto; position: relative; height: 320px; }
#history-chart { display: block; width: 100% !important; height: 100% !important; }
#snapshot-btn { display: block; margin: 1.2em auto 0 auto; }

/* Achievements Section (Detail Modal) */
.achievements-section ul { display: flex; flex-wrap: wrap; gap: 1em; margin-top: 0.8em; padding-left: 0; justify-content: center; }
.achievements-section li { background: var(--bg-color); border: var(--border-width) solid var(--border-color); padding: 0.6em 1.2em; border-radius: var(--border-radius-medium); text-align: center; display: flex; flex-direction: column; align-items: center; gap: 0.3em; min-width: 110px; transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing), transform 0.1s ease; }
.achievements-section li:hover { transform: translateY(-2px); border-color: var(--accent-color-light); }
.achievement-icon { font-size: 1.6em; line-height: 1; }
.achievement-name { font-weight: bold; font-size: 0.85em; }

/* Kink Reading Section (Detail Modal) */
.kink-reading-section h3 { display: flex; align-items: center; justify-content: space-between;}
#reading-btn { margin-left: auto; }
.kink-reading-output { background: linear-gradient(135deg, var(--bg-color), color-mix(in srgb, var(--bg-color) 80%, var(--accent-color-light))); border: var(--border-width-thick) dashed var(--accent-color); border-radius: var(--border-radius-small); padding: 1.8em; margin-top: 1.2em; text-align: center; font-style: italic; white-space: pre-wrap; font-size: 0.95em; line-height: 1.7; transition: background var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }

/* Reflections Section (Detail Modal) */
.reflections-section .modal-actions { margin-bottom: 1.2em; text-align: center; }
.reflections-textarea { display: block; width: 100%; min-height: 150px; margin-bottom: 1.2em; line-height: 1.7; /* Inherits general input styles */ }
#save-reflections-btn { display: block; margin: 0 auto; }
.journal-prompt { background-color: color-mix(in srgb, var(--bg-color) 90%, var(--accent-color)); padding: 1em; border-radius: var(--border-radius-small); margin-bottom: 1.2em; font-style: italic; text-align: center; transition: background-color var(--transition-duration) var(--transition-timing); border-left: 4px solid var(--accent-color); }


/* --- Other Auxiliary Modals --- */
#resources-modal dl dt { margin-top: 1.3em; font-size: 1.15em; }
#resources-modal dl dd { margin-left: 1.2em; margin-bottom: 0.9em; }
#glossary-body dl dt { font-weight: bold; color: var(--accent-color); margin-top: 1.2em; transition: color var(--transition-duration) var(--transition-timing); }
#glossary-body dl dd { margin-left: 1.5em; margin-bottom: 0.6em; }
#glossary-body .related-terms { font-size: 0.85em; color: var(--muted-text-color); transition: color var(--transition-duration) var(--transition-timing); }
#glossary-body .related-terms a { color: var(--muted-text-color); text-decoration: underline; }
#glossary-body .related-terms a:hover { color: var(--link-hover-color); }
.style-discovery-controls { margin-bottom: 1.2em; display: flex; gap: 1em; align-items: center; border-bottom: var(--border-width) solid var(--border-color); padding-bottom: 1em; }
#style-discovery-body { max-height: 65vh; overflow-y: auto; padding-right: 0.8em; margin-top: 1em;}
.style-discovery-item { margin-bottom: 1.5em; padding: 1.2em; border: var(--border-width) solid var(--border-color); border-radius: var(--border-radius-small); background: var(--bg-color); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.style-discovery-item h4 { margin-top: 0; color: var(--accent-color); }
.style-discovery-item p { font-style: italic; color: var(--muted-text-color); margin-bottom: 0.8em; font-size: 0.95em;}
.style-discovery-item ul { list-style: disc; padding-left: 1.8em; margin-top: 0.6em; }
.style-discovery-item li { font-size: 0.9em; color: var(--muted-text-color); margin-bottom: 0.3em; }
.theme-options { display: flex; flex-wrap: wrap; gap: 1.2em; justify-content: center; padding: 1.5em 0; }
.theme-option-btn { padding: 0.9em 1.8em; border-radius: var(--border-radius-small); border: var(--border-width-thick) solid var(--border-color); cursor: pointer; font-weight: bold; background-color: var(--bg-color); color: var(--text-color); transition: background-color 0.2s ease, border-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease; min-width: 120px; text-align: center; }
.theme-option-btn:hover { border-color: var(--accent-color); transform: scale(1.03); box-shadow: var(--button-shadow); }
.theme-option-btn[data-theme=light] { background: #fff0f5; border-color: #f4d4e4; color: #4a2c3d; }
.theme-option-btn[data-theme=dark] { background: #3c2f3c; border-color: #5a3f5a; color: #f4d4e4; }
.theme-option-btn[data-theme=pastel] { background: #fdf6f9; border-color: #e8ddee; color: #6d5a6d; }
.theme-option-btn[data-theme=velvet] { background: #2c1f3e; border-color: #4a3a5f; color: #e8ddee; }


/* --- Style Finder Specific Styles --- */
.sf-modal .sf-modal-content { background: var(--sf-modal-bg, var(--card-bg-color)); padding: 25px; max-width: 600px; border-color: var(--accent-color); }
.sf-modal-content h3 { color: var(--accent-color); margin-bottom: 18px; font-size: 1.6em; margin-top: 0; text-align: center; }
#sf-close-style-finder { /* Uses .modal-close */ }
#sf-progress-tracker { font-size: 0.95em; color: var(--sf-progress-color, var(--muted-text-color)); margin-bottom: 18px; font-weight: bold; text-align: center; transition: color var(--transition-duration) var(--transition-timing); }
#sf-step-content { padding: 0.5em 0; }
#sf-step-content h2 { color: var(--accent-color-darker); margin-bottom: 12px; font-size: 1.35em; line-height: 1.4; text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.4em; }
#sf-step-content p { margin-bottom: 18px; color: var(--text-color); text-align: center; font-size: 0.95em; }
#sf-step-content button { background: var(--accent-color); color: var(--text-color-light); border: none; padding: 0.8em 1.6em; border-radius: 50px; cursor: pointer; font-size: 1em; font-weight: bold; margin: 8px 5px; transition: all 0.2s ease; }
#sf-step-content button:hover { background: var(--accent-color-darker); transform: translateY(-2px); box-shadow: var(--button-shadow); }
#sf-step-content .sf-button-container { display: flex; justify-content: center; flex-wrap: wrap; gap: 1em; margin-top: 20px; /* Increased margin */ }
#sf-step-content button[data-action="prev"] { background: var(--muted-text-color); color: var(--card-bg-color); }
#sf-step-content button[data-action="prev"]:hover { background: var(--text-color); }
#sf-feedback { font-size: 0.95em; color: var(--accent-color); margin: 12px 0; font-weight: bold; min-height: 1.3em; text-align: center; transition: color var(--transition-duration) var(--transition-timing); }
#sf-dashboard { margin: 25px auto 10px auto; max-width: 450px; font-size: 0.9em; color: var(--text-color); max-height: 280px; overflow-y: auto; padding: 5px; border: var(--border-width) solid var(--border-color); border-radius: var(--border-radius-small); background: var(--bg-color); transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing), color var(--transition-duration) var(--transition-timing); }
.sf-dashboard-header { font-size: 1.25em; color: var(--accent-color); margin-bottom: 12px; text-align: center; font-weight: bold; position: sticky; top: -6px; background: inherit; padding: 10px 0 8px 0; z-index: 1; border-bottom: var(--border-width) dashed var(--accent-color); }
.sf-dashboard-item { display: flex; justify-content: space-between; align-items: center; background: var(--sf-dashboard-item-bg, color-mix(in srgb, var(--accent-color) 20%, transparent)); border-radius: var(--border-radius-small); padding: 10px 15px; margin: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); transition: transform 0.2s ease, background-color 0.3s ease; }
.sf-style-name { font-family: var(--font-family-base); font-size: 1em; font-weight: 600; color: var(--text-color); transition: color var(--transition-duration) var(--transition-timing); display: flex; align-items: center; gap: 0.5em; }
.sf-dashboard-score { font-weight: bold; display: flex; align-items: center; gap: 6px; color: var(--accent-color-darker); transition: color var(--transition-duration) var(--transition-timing); }
body[data-theme="dark"] .sf-dashboard-score, body[data-theme="velvet"] .sf-dashboard-score { color: var(--accent-color); }
.sf-move-up, .sf-move-down { color: var(--accent-color); font-size: 1.2em; opacity: 1; animation: sfFadeOut 1s ease forwards; transition: color var(--transition-duration) var(--transition-timing); }
.sf-score-delta { font-size: 0.85em; padding: 3px 7px; border-radius: 10px; background: color-mix(in srgb, var(--accent-color) 25%, transparent); transition: background-color var(--transition-duration) var(--transition-timing), color var(--transition-duration) var(--transition-timing); }
.sf-score-delta.positive { color: var(--accent-color-darker); }
body[data-theme="dark"] .sf-score-delta.positive, body[data-theme="velvet"] .sf-score-delta.positive { color: var(--accent-color); }
.sf-score-delta.negative { color: var(--sf-score-delta-negative-color, var(--muted-text-color)); background: color-mix(in srgb, var(--muted-text-color) 25%, transparent); }
.sf-trait-slider { width: 100%; max-width: 400px; margin: 20px auto 8px auto; -webkit-appearance: none; appearance: none; height: 8px; background: var(--sf-slider-track-bg, var(--border-color)); border-radius: 5px; outline: none; transition: background var(--transition-duration) var(--transition-timing); display: block; cursor: grab; }
.sf-trait-slider:active { cursor: grabbing; }
.sf-trait-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 22px; height: 22px; background: var(--accent-color); border-radius: 50%; cursor: pointer; transition: all 0.2s ease; border: 2px solid var(--card-bg-color); }
.sf-trait-slider::-moz-range-thumb { width: 18px; height: 18px; background: var(--accent-color); border-radius: 50%; cursor: pointer; border: 2px solid var(--card-bg-color); transition: all 0.2s ease; }
.sf-trait-slider::-webkit-slider-thumb:hover { background: var(--accent-color-darker); transform: scale(1.1); }
.sf-trait-slider::-moz-range-thumb:hover { background: var(--accent-color-darker); transform: scale(1.1); }
.sf-slider-description { font-size: 1em; color: var(--accent-color); margin-top: 12px; font-weight: bold; transition: all 0.2s ease; text-align: center; padding: 10px 15px; background: color-mix(in srgb, var(--accent-color) 10%, transparent); border-radius: var(--border-radius-small); max-width: 400px; margin-left: auto; margin-right: auto; min-height: 2.8em; display: flex; align-items: center; justify-content: center; }
.sf-slider-footnote { font-size: 0.85em; color: var(--sf-slider-footnote-color, var(--muted-text-color)); margin-top: 8px; text-align: center; transition: color var(--transition-duration) var(--transition-timing); }
.sf-info-icon { cursor: pointer; color: var(--accent-color); background-color: color-mix(in srgb, var(--accent-color) 15%, transparent); border: 1px solid color-mix(in srgb, var(--accent-color) 40%, transparent); border-radius: 50%; width: 1.6em; height: 1.6em; font-size: 0.85em; font-weight: bold; display: inline-flex; align-items: center; justify-content: center; margin-left: 0.6em; vertical-align: middle; transition: all 0.2s ease; line-height: 1; padding: 0; text-decoration: none; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
.sf-info-icon:hover { transform: scale(1.15) rotate(10deg); color: var(--accent-color-darker); background-color: color-mix(in srgb, var(--accent-color) 25%, transparent); border-color: var(--accent-color); box-shadow: 0 0 6px color-mix(in srgb, var(--accent-color) 50%, transparent); }
/* Info Popups */
.sf-style-info-popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--sf-popup-bg, var(--card-bg-color)); padding: 25px; border-radius: var(--border-radius-medium); max-width: 500px; width: 90%; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3); z-index: 1001; text-align: left; border: var(--border-width-thick) solid var(--accent-color); max-height: 85vh; overflow-y: auto; transition: background-color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.sf-style-info-popup.wide-popup { max-width: 650px; }
.sf-style-info-popup h3 { color: var(--accent-color); margin-bottom: 12px; margin-top: 0; font-size: 1.4em; }
.sf-style-info-popup p { margin-bottom: 12px; line-height: 1.6; font-size: 0.95em; }
.sf-style-info-popup ul { list-style: 'âœ¨ '; padding-left: 1.8em; margin: 0.8em 0 1.2em 0; }
.sf-style-info-popup li { margin-bottom: 0.5em; }
.sf-style-info-popup h4 { color: var(--accent-color-darker); margin: 1.2em 0 0.6em 0; font-size: 1.15em; }
.sf-close-btn { position: absolute; top: 10px; right: 12px; background: none; border: none; font-size: 1.8em; line-height: 1; color: var(--accent-color); cursor: pointer; transition: color 0.2s ease, transform 0.2s ease; padding: 0.1em 0.3em; }
.sf-close-btn:hover { color: var(--accent-color-darker); transform: scale(1.1) rotate(90deg); }

/* Result Section */
.sf-result-section { margin: 25px 0 10px 0; animation: sfSlideIn 0.5s ease-out; padding: 1.5em 0; border-top: var(--border-width) dashed var(--border-color); }
.sf-result-heading { color: var(--accent-color); padding-bottom: 8px; margin-bottom: 18px; font-size: 1.7em; text-align: center; }
.sf-result-section p { margin-bottom: 1em; text-align: left; margin-left: auto; margin-right: auto; max-width: 90%; }
.sf-result-section h3 { font-size: 1.4em; margin-top: 1.8em; margin-bottom: 0.6em; color: var(--accent-color-darker); text-align: center; }
.sf-result-section ul { text-align: left; max-width: 400px; margin: 0.5em auto 1.8em auto; padding-left: 1.8em; }
.sf-result-buttons { display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; margin-top: 25px; }
.sf-result-buttons button[data-action="applyStyle"] { background-color: var(--success-color); color: var(--text-color-light); }
.sf-result-buttons button[data-action="applyStyle"]:hover { background-color: color-mix(in srgb, var(--success-color) 80%, black); }

/* --- Animations (Prefixed) --- */
.sf-fade-in { animation: sfFadeIn 0.3s ease-in; }
@keyframes sfFadeIn { from { opacity: 0; } to { opacity: 1; } }
.sf-feedback-animation { animation: sfBounce 0.5s ease; }
@keyframes sfBounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
@keyframes sfSlideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
@keyframes sfFadeOut { 0% { opacity: 1; } 100% { opacity: 0; } }

/* --- Footer --- */
.app-footer { text-align: center; padding: 1.8em 1em; margin-top: 2.5em; color: var(--muted-text-color); font-size: 0.9em; border-top: var(--border-width) solid var(--border-color); transition: color var(--transition-duration) var(--transition-timing), border-color var(--transition-duration) var(--transition-timing); }
.app-footer small { font-size: 0.85em; }

/* --- Utility Classes --- */
.muted-text { color: var(--muted-text-color); font-size: 0.9em; transition: color var(--transition-duration) var(--transition-timing); }

/* --- Notification Styles --- */
#app-notification { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); padding: 12px 25px; border-radius: 8px; z-index: 2000; opacity: 0; transition: opacity 0.5s ease, top 0.5s ease; box-shadow: 0 4px 12px rgba(0,0,0,0.2); font-size: 0.95em; text-align: center; pointer-events: none; /* Prevent interaction */ }
.notification-success { background-color: var(--notification-success-bg, var(--success-color)); color: var(--notification-text-light, white); }
.notification-error { background-color: var(--notification-error-bg, var(--danger-color)); color: var(--notification-text-light, white); }
.notification-warning { background-color: var(--notification-warning-bg, #ff9800); color: var(--notification-text-dark, black); }
.notification-info { background-color: var(--notification-info-bg, var(--accent-color)); color: var(--notification-text-light, white); }


/* --- Responsiveness --- */
@media (max-width: 900px) { .modal-content.wide-modal { width: 90%; } .sf-style-info-popup.wide-popup { max-width: 90%; } }
@media (max-width: 768px) { .container { padding: 1em; gap: 1em; } .card { padding: 1.2em; } .app-header { padding: 0.8em 1em; } .app-header h1 { font-size: clamp(1.3em, 4vw, 1.6em); } .header-nav { gap: 0.4em; align-items: center; /* Reset */ } .header-btn { height: auto; padding: 0.3em 0.6em; font-size: clamp(0.7em, 1.8vw, 0.8em); } .theme-btn { font-size: 1.1em;} .modal-content { padding: 1.5em; max-width: 95%; width: auto; } .form-actions { flex-direction: column; } .trait-details-grid { grid-template-columns: 1fr; } .sf-modal .sf-modal-content { max-width: 95%; padding: 20px; } #sf-step-content h2 { font-size: 1.25em; } }
@media (max-width: 480px) { body { font-size: 15px; } .app-header { flex-direction: column; align-items: flex-start; } .app-header h1 { margin-bottom: 0.5em; width: 100%; text-align: center; } .header-nav { margin-left: 0; width: 100%; justify-content: space-around; gap: 0.5em; } .header-btn { padding: 0.5em 0.8em; } .container { grid-template-columns: 1fr; padding: 0.8em; gap: 0.8em; } .card { padding: 1em; } .modal-content { padding: 1.2em; } .form-actions { gap: 0.8em; } .save-btn, .clear-btn { font-size: 1em; padding: 0.7em 1.5em; } .sf-modal .sf-modal-content { padding: 15px; } .sf-modal-content h3 { font-size: 1.4em; } #sf-step-content h2 { font-size: 1.15em; flex-direction: column; /* Stack icon above text */ gap: 0.2em; } .sf-trait-slider { max-width: 95%; } .sf-slider-description { font-size: 0.9em; padding: 8px 10px; min-height: 2.5em; } .sf-slider-footnote { font-size: 0.8em; } .sf-style-info-popup { max-width: 95%; padding: 15px; } .sf-style-info-popup h3 { font-size: 1.2em; } .sf-result-section ul { max-width: 90%; } #sf-step-content button { padding: 0.7em 1.4em; font-size: 0.95em; } .sf-result-buttons { gap: 8px; } }

/* --- END OF FILE styles.css --- */
